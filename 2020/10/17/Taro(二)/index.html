<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Taro(äºŒ) | YolkPie</title><meta name="description" content="å››ã€CLI åŸç†åŠä¸åŒç«¯çš„è¿è¡Œæœºåˆ¶4.1 taro-cli åŒ…4.1.1 Taro å‘½ä»¤ taro-cli åŒ…ä½äº Taro å·¥ç¨‹çš„ Packages ç›®å½•ä¸‹ï¼Œé€šè¿‡ npm install -g @tarojs&#x2F;cli å…¨å±€å®‰è£…åï¼Œå°†ä¼šç”Ÿæˆä¸€ä¸ª Taro å‘½ä»¤ã€‚ä¸»è¦è´Ÿè´£é¡¹ç›®åˆå§‹åŒ–ã€ç¼–è¯‘ã€æ„å»ºç­‰ã€‚ç›´æ¥åœ¨å‘½ä»¤è¡Œè¾“å…¥ Taro ï¼Œä¼šçœ‹åˆ°å¦‚ä¸‹æç¤ºâ€¦  1234567891011121314151617âœ"><meta name="keywords" content="å‰ç«¯æŠ€æœ¯åšå®¢"><meta name="author" content="YolkPie"><meta name="copyright" content="YolkPie"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://yolkpie.net/2020/10/17/Taro(%E4%BA%8C)/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="Taro(äºŒ)"><meta property="og:url" content="https://yolkpie.net/2020/10/17/Taro(%E4%BA%8C)/"><meta property="og:site_name" content="YolkPie"><meta property="og:description" content="å››ã€CLI åŸç†åŠä¸åŒç«¯çš„è¿è¡Œæœºåˆ¶4.1 taro-cli åŒ…4.1.1 Taro å‘½ä»¤ taro-cli åŒ…ä½äº Taro å·¥ç¨‹çš„ Packages ç›®å½•ä¸‹ï¼Œé€šè¿‡ npm install -g @tarojs&#x2F;cli å…¨å±€å®‰è£…åï¼Œå°†ä¼šç”Ÿæˆä¸€ä¸ª Taro å‘½ä»¤ã€‚ä¸»è¦è´Ÿè´£é¡¹ç›®åˆå§‹åŒ–ã€ç¼–è¯‘ã€æ„å»ºç­‰ã€‚ç›´æ¥åœ¨å‘½ä»¤è¡Œè¾“å…¥ Taro ï¼Œä¼šçœ‹åˆ°å¦‚ä¸‹æç¤ºâ€¦  1234567891011121314151617âœ"><meta property="og:image" content="https://m.360buyimg.com/img/jfs/t1/118880/20/18814/113416/5f6ded26Ec120c939/bd3281048222ce87.png"><meta property="article:published_time" content="2020-10-17T05:47:09.000Z"><meta property="article:modified_time" content="2022-06-29T06:48:23.671Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="prev" title="Taro(ä¸‰)" href="https://yolkpie.net/2020/10/17/Taro(%E4%B8%89)/"><link rel="next" title="äº¬ä¸œå°ç¨‹åº-çˆ¬å‘è·¯-äºŒ" href="https://yolkpie.net/2020/10/13/%E4%BA%AC%E4%B8%9C%E5%B0%8F%E7%A8%8B%E5%BA%8F-%E7%88%AC%E5%9D%91%E8%B7%AF-%E4%BA%8C/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  bookmark: {
    message_prev: 'æŒ‰',
    message_next: 'é”®å°†æœ¬é¡µåŠ å…¥ä¹¦ç­¾'
  },
  runtime_unit: 'å¤©',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 5.0.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length_num">167</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length_num">84</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length_num">35</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B%E3%80%81CLI-%E5%8E%9F%E7%90%86%E5%8F%8A%E4%B8%8D%E5%90%8C%E7%AB%AF%E7%9A%84%E8%BF%90%E8%A1%8C%E6%9C%BA%E5%88%B6"><span class="toc-number">1.</span> <span class="toc-text">å››ã€CLI åŸç†åŠä¸åŒç«¯çš„è¿è¡Œæœºåˆ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-taro-cli-%E5%8C%85"><span class="toc-number">1.1.</span> <span class="toc-text">4.1 taro-cli åŒ…</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-1-Taro-%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.1.</span> <span class="toc-text">4.1.1 Taro å‘½ä»¤</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-2-%E5%8C%85%E7%AE%A1%E7%90%86%E4%B8%8E%E5%8F%91%E5%B8%83"><span class="toc-number">1.1.2.</span> <span class="toc-text">4.1.2 åŒ…ç®¡ç†ä¸å‘å¸ƒ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-3-taro-cli-%E5%8C%85%E7%9A%84%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84%E5%A6%82%E4%B8%8B"><span class="toc-number">1.1.3.</span> <span class="toc-text">4.1.3 taro-cli åŒ…çš„ç›®å½•ç»“æ„å¦‚ä¸‹</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E7%94%A8%E5%88%B0%E7%9A%84%E6%A0%B8%E5%BF%83%E5%BA%93"><span class="toc-number">1.2.</span> <span class="toc-text">4.2 ç”¨åˆ°çš„æ ¸å¿ƒåº“</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-Taro-Init"><span class="toc-number">1.3.</span> <span class="toc-text">4.3 Taro Init</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-1-%E5%91%BD%E4%BB%A4%E5%85%B3%E8%81%94%E4%B8%8E%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90"><span class="toc-number">1.3.1.</span> <span class="toc-text">4.3.1 å‘½ä»¤å…³è”ä¸å‚æ•°è§£æ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90%E5%8F%8A%E4%B8%8E%E7%94%A8%E6%88%B7%E4%BA%A4%E4%BA%92"><span class="toc-number">1.3.2.</span> <span class="toc-text">4.3.2 å‚æ•°è§£æåŠä¸ç”¨æˆ·äº¤äº’</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-3-%E6%A8%A1%E7%89%88%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">1.3.3.</span> <span class="toc-text">4.3.3 æ¨¡ç‰ˆæ–‡ä»¶æ“ä½œ</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-Taro-Build"><span class="toc-number">1.4.</span> <span class="toc-text">4.4 Taro Build</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-1-%E7%BC%96%E8%AF%91%E5%B7%A5%E4%BD%9C%E6%B5%81%E4%B8%8E%E6%8A%BD%E8%B1%A1%E8%AF%AD%E6%B3%95%E6%A0%91%EF%BC%88AST%EF%BC%89"><span class="toc-number">1.4.1.</span> <span class="toc-text">4.4.1 ç¼–è¯‘å·¥ä½œæµä¸æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-2-Babel-%E6%A8%A1%E5%9D%97"><span class="toc-number">1.4.2.</span> <span class="toc-text">4.4.2 Babel æ¨¡å—</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-3-%E8%A7%A3%E6%9E%90%E9%A1%B5%E9%9D%A2-Config-%E9%85%8D%E7%BD%AE"><span class="toc-number">1.4.3.</span> <span class="toc-text">4.4.3 è§£æé¡µé¢ Config é…ç½®</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94%E3%80%81Taro-%E7%BB%84%E4%BB%B6%E5%BA%93%E5%8F%8A-API-%E7%9A%84%E8%AE%BE%E8%AE%A1%E4%B8%8E%E9%80%82%E9%85%8D"><span class="toc-number">2.</span> <span class="toc-text">äº”ã€Taro ç»„ä»¶åº“åŠ API çš„è®¾è®¡ä¸é€‚é…</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%A4%9A%E7%AB%AF%E5%B7%AE%E5%BC%82"><span class="toc-number">2.1.</span> <span class="toc-text">5.1 å¤šç«¯å·®å¼‚</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-1-%E7%BB%84%E4%BB%B6%E5%B7%AE%E5%BC%82"><span class="toc-number">2.1.1.</span> <span class="toc-text">5.1.1 ç»„ä»¶å·®å¼‚</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-2-API-%E5%B7%AE%E5%BC%82"><span class="toc-number">2.1.2.</span> <span class="toc-text">5.1.2 API å·®å¼‚</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-%E5%A4%9A%E7%AB%AF%E9%80%82%E9%85%8D"><span class="toc-number">2.2.</span> <span class="toc-text">5.2 å¤šç«¯é€‚é…</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-1-%E6%A0%B7%E5%BC%8F%E5%A4%84%E7%90%86"><span class="toc-number">2.2.1.</span> <span class="toc-text">5.2.1 æ ·å¼å¤„ç†</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-2-2-%E7%BB%84%E4%BB%B6%E5%B0%81%E8%A3%85"><span class="toc-number">2.2.2.</span> <span class="toc-text">5.2.2 ç»„ä»¶å°è£…</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD%E3%80%81JSX-%E8%BD%AC%E6%8D%A2%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-number">3.</span> <span class="toc-text">å…­ã€JSX è½¬æ¢å¾®ä¿¡å°ç¨‹åºæ¨¡æ¿çš„å®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E4%BB%A3%E7%A0%81%E7%9A%84%E6%9C%AC%E8%B4%A8"><span class="toc-number">3.1.</span> <span class="toc-text">6.1 ä»£ç çš„æœ¬è´¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-Babel"><span class="toc-number">3.2.</span> <span class="toc-text">6.2 Babel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E5%AE%9E%E8%B7%B5%E4%BE%8B%E5%AD%90"><span class="toc-number">3.3.</span> <span class="toc-text">6.3 å®è·µä¾‹å­</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-1-%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF"><span class="toc-number">3.3.1.</span> <span class="toc-text">6.3.1 è®¾è®¡æ€è·¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-3-2-WXML-%E5%92%8C-JSX"><span class="toc-number">3.3.2.</span> <span class="toc-text">6.3.2 WXML å’Œ JSX</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://m.360buyimg.com/img/jfs/t1/118880/20/18814/113416/5f6ded26Ec120c939/bd3281048222ce87.png)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">YolkPie</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">Taro(äºŒ)</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="å‘è¡¨äº 2020-10-17 13:47:09"><i class="far fa-calendar-alt fa-fw"></i> å‘è¡¨äº 2020-10-17</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="æ›´æ–°äº 2022-06-29 14:48:23"><i class="fas fa-history fa-fw"></i> æ›´æ–°äº 2022-06-29</span></time></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta__icon"></i><span>é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="å››ã€CLI-åŸç†åŠä¸åŒç«¯çš„è¿è¡Œæœºåˆ¶"><a href="#å››ã€CLI-åŸç†åŠä¸åŒç«¯çš„è¿è¡Œæœºåˆ¶" class="headerlink" title="å››ã€CLI åŸç†åŠä¸åŒç«¯çš„è¿è¡Œæœºåˆ¶"></a>å››ã€CLI åŸç†åŠä¸åŒç«¯çš„è¿è¡Œæœºåˆ¶</h2><h3 id="4-1-taro-cli-åŒ…"><a href="#4-1-taro-cli-åŒ…" class="headerlink" title="4.1 taro-cli åŒ…"></a>4.1 taro-cli åŒ…</h3><h4 id="4-1-1-Taro-å‘½ä»¤"><a href="#4-1-1-Taro-å‘½ä»¤" class="headerlink" title="4.1.1 Taro å‘½ä»¤"></a>4.1.1 Taro å‘½ä»¤</h4><blockquote>
<p>taro-cli åŒ…ä½äº Taro å·¥ç¨‹çš„ Packages ç›®å½•ä¸‹ï¼Œé€šè¿‡ npm install -g @tarojs/cli å…¨å±€å®‰è£…åï¼Œå°†ä¼šç”Ÿæˆä¸€ä¸ª Taro å‘½ä»¤ã€‚ä¸»è¦è´Ÿè´£é¡¹ç›®åˆå§‹åŒ–ã€ç¼–è¯‘ã€æ„å»ºç­‰ã€‚ç›´æ¥åœ¨å‘½ä»¤è¡Œè¾“å…¥ Taro ï¼Œä¼šçœ‹åˆ°å¦‚ä¸‹æç¤ºâ€¦</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">âœ taro</span><br><span class="line">ğŸ‘½ Taro v0<span class="number">.0</span><span class="number">.63</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  Usage: taro &lt;command&gt; [options]</span><br><span class="line"></span><br><span class="line">  Options:</span><br><span class="line"></span><br><span class="line">    -V, --version       output the version number</span><br><span class="line">    -h, --help          output usage information</span><br><span class="line"></span><br><span class="line">  Commands:</span><br><span class="line"></span><br><span class="line">    init [projectName]  Init a project <span class="keyword">with</span> <span class="keyword">default</span> templete</span><br><span class="line">    build               Build a project <span class="keyword">with</span> options</span><br><span class="line">    update              Update packages <span class="keyword">of</span> taro</span><br><span class="line">    help [cmd]          display help <span class="keyword">for</span> [cmd]...</span><br></pre></td></tr></table></figure>

<p>é‡Œé¢åŒ…å«äº† Taro æ‰€æœ‰å‘½ä»¤ç”¨æ³•åŠä½œç”¨ã€‚</p>
<h4 id="4-1-2-åŒ…ç®¡ç†ä¸å‘å¸ƒ"><a href="#4-1-2-åŒ…ç®¡ç†ä¸å‘å¸ƒ" class="headerlink" title="4.1.2 åŒ…ç®¡ç†ä¸å‘å¸ƒ"></a>4.1.2 åŒ…ç®¡ç†ä¸å‘å¸ƒ</h4><ul>
<li>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦äº†è§£ taro-cli åŒ…ä¸ Taro å·¥ç¨‹çš„å…³ç³»ã€‚</li>
<li>å°† Taro å·¥ç¨‹ Clone ä¹‹åï¼Œå¯ä»¥çœ‹åˆ°å·¥ç¨‹çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼Œæ•´ä½“ç»“æ„è¿˜æ˜¯æ¯”è¾ƒæ¸…æ™°çš„ï¼š</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ CHANGELOG.md</span><br><span class="line">â”œâ”€â”€ LICENSE</span><br><span class="line">â”œâ”€â”€ README.md</span><br><span class="line">â”œâ”€â”€ build</span><br><span class="line">â”œâ”€â”€ docs</span><br><span class="line">â”œâ”€â”€ lerna-debug.log</span><br><span class="line">â”œâ”€â”€ lerna.json        <span class="comment">// Lerna é…ç½®æ–‡ä»¶</span></span><br><span class="line">â”œâ”€â”€ package.json</span><br><span class="line">â”œâ”€â”€ packages</span><br><span class="line">â”‚   â”œâ”€â”€ eslint-config-taro</span><br><span class="line">â”‚   â”œâ”€â”€ eslint-plugin-taro</span><br><span class="line">â”‚   â”œâ”€â”€ postcss-plugin-constparse</span><br><span class="line">â”‚   â”œâ”€â”€ postcss-pxtransform</span><br><span class="line">â”‚   â”œâ”€â”€ taro</span><br><span class="line">â”‚   â”œâ”€â”€ taro-<span class="keyword">async</span>-<span class="keyword">await</span></span><br><span class="line">â”‚   â”œâ”€â”€ taro-cli</span><br><span class="line">â”‚   â”œâ”€â”€ taro-components</span><br><span class="line">â”‚   â”œâ”€â”€ taro-components-rn</span><br><span class="line">â”‚   â”œâ”€â”€ taro-h5</span><br><span class="line">â”‚   â”œâ”€â”€ taro-plugin-babel</span><br><span class="line">â”‚   â”œâ”€â”€ taro-plugin-csso</span><br><span class="line">â”‚   â”œâ”€â”€ taro-plugin-sass</span><br><span class="line">â”‚   â”œâ”€â”€ taro-plugin-uglifyjs</span><br><span class="line">â”‚   â”œâ”€â”€ taro-redux</span><br><span class="line">â”‚   â”œâ”€â”€ taro-redux-h5</span><br><span class="line">â”‚   â”œâ”€â”€ taro-rn</span><br><span class="line">â”‚   â”œâ”€â”€ taro-rn-runner</span><br><span class="line">â”‚   â”œâ”€â”€ taro-router</span><br><span class="line">â”‚   â”œâ”€â”€ taro-transformer-wx</span><br><span class="line">â”‚   â”œâ”€â”€ taro-weapp</span><br><span class="line">â”‚   â””â”€â”€ taro-webpack-runner</span><br><span class="line">â””â”€â”€ yarn.lock...</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Taro é¡¹ç›®ä¸»è¦æ˜¯ç”±ä¸€ç³»åˆ— NPM åŒ…ç»„æˆï¼Œä½äºå·¥ç¨‹çš„ Packages ç›®å½•ä¸‹ã€‚å®ƒçš„åŒ…ç®¡ç†æ–¹å¼å’Œ Babel é¡¹ç›®ä¸€æ ·ï¼Œå°†æ•´ä¸ªé¡¹ç›®ä½œä¸ºä¸€ä¸ª monorepo æ¥è¿›è¡Œç®¡ç†ï¼Œå¹¶ä¸”åŒæ ·ä½¿ç”¨äº†åŒ…ç®¡ç†å·¥å…· Lerna</p>
</blockquote>
<p>Packages ç›®å½•ä¸‹åå‡ ä¸ªåŒ…ä¸­ï¼Œæœ€å¸¸ç”¨çš„é¡¹ç›®åˆå§‹åŒ–ä¸æ„å»ºçš„å‘½ä»¤è¡Œå·¥å…· Taro CLI å°±æ˜¯å…¶ä¸­ä¸€ä¸ªã€‚åœ¨ Taro å·¥ç¨‹æ ¹ç›®å½•è¿è¡Œ lerna publish å‘½ä»¤ä¹‹åï¼Œlerna.json é‡Œé¢é…ç½®å¥½çš„æ‰€æœ‰çš„åŒ…ä¼šè¢«å‘å¸ƒåˆ° NPM ä¸Š</p>
<h4 id="4-1-3-taro-cli-åŒ…çš„ç›®å½•ç»“æ„å¦‚ä¸‹"><a href="#4-1-3-taro-cli-åŒ…çš„ç›®å½•ç»“æ„å¦‚ä¸‹" class="headerlink" title="4.1.3 taro-cli åŒ…çš„ç›®å½•ç»“æ„å¦‚ä¸‹"></a>4.1.3 taro-cli åŒ…çš„ç›®å½•ç»“æ„å¦‚ä¸‹</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">./</span><br><span class="line">â”œâ”€â”€ bin        <span class="comment">// å‘½ä»¤è¡Œ</span></span><br><span class="line">â”‚   â”œâ”€â”€ taro              <span class="comment">// taro å‘½ä»¤</span></span><br><span class="line">â”‚   â”œâ”€â”€ taro-build        <span class="comment">// taro build å‘½ä»¤</span></span><br><span class="line">â”‚   â”œâ”€â”€ taro-update       <span class="comment">// taro update å‘½ä»¤</span></span><br><span class="line">â”‚   â””â”€â”€ taro-init         <span class="comment">// taro init å‘½ä»¤</span></span><br><span class="line">â”œâ”€â”€ package.json</span><br><span class="line">â”œâ”€â”€ node_modules</span><br><span class="line">â”œâ”€â”€ src</span><br><span class="line">â”‚   â”œâ”€â”€ build.js        <span class="comment">// taro build å‘½ä»¤è°ƒç”¨ï¼Œæ ¹æ® type ç±»å‹è°ƒç”¨ä¸åŒçš„è„šæœ¬</span></span><br><span class="line">â”‚   â”œâ”€â”€ config</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ babel.js        <span class="comment">// Babel é…ç½®</span></span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ babylon.js      <span class="comment">// JavaScript è§£æå™¨ babylon é…ç½®</span></span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ browser_list.js <span class="comment">// autoprefixer browsers é…ç½®</span></span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ index.js        <span class="comment">// ç›®å½•ååŠå…¥å£æ–‡ä»¶åç›¸å…³é…ç½®</span></span><br><span class="line">â”‚   â”‚   â””â”€â”€ uglify.js</span><br><span class="line">â”‚   â”œâ”€â”€ creator.js</span><br><span class="line">â”‚   â”œâ”€â”€ h5.js       <span class="comment">// æ„å»ºh5 å¹³å°ä»£ç </span></span><br><span class="line">â”‚   â”œâ”€â”€ project.js  <span class="comment">// taro init å‘½ä»¤è°ƒç”¨ï¼Œåˆå§‹åŒ–é¡¹ç›®</span></span><br><span class="line">â”‚   â”œâ”€â”€ rn.js       <span class="comment">// æ„å»ºReact Native å¹³å°ä»£ç </span></span><br><span class="line">â”‚   â”œâ”€â”€ util        <span class="comment">// ä¸€ç³»åˆ—å·¥å…·å‡½æ•°</span></span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ index.js</span><br><span class="line">â”‚   â”‚   â”œâ”€â”€ npm.js</span><br><span class="line">â”‚   â”‚   â””â”€â”€ resolve_npm_files.js</span><br><span class="line">â”‚   â””â”€â”€ weapp.js        <span class="comment">// æ„å»ºå°ç¨‹åºä»£ç è½¬æ¢</span></span><br><span class="line">â”œâ”€â”€ templates           <span class="comment">// è„šæ‰‹æ¶æ¨¡ç‰ˆ</span></span><br><span class="line">â”‚   â””â”€â”€ <span class="keyword">default</span></span><br><span class="line">â”‚       â”œâ”€â”€ appjs</span><br><span class="line">â”‚       â”œâ”€â”€ config</span><br><span class="line">â”‚       â”‚   â”œâ”€â”€ dev</span><br><span class="line">â”‚       â”‚   â”œâ”€â”€ index</span><br><span class="line">â”‚       â”‚   â””â”€â”€ prod</span><br><span class="line">â”‚       â”œâ”€â”€ editorconfig</span><br><span class="line">â”‚       â”œâ”€â”€ eslintrc</span><br><span class="line">â”‚       â”œâ”€â”€ gitignor...</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é€šè¿‡ä¸Šé¢çš„ç›®å½•æ ‘å¯ä»¥å‘ç°ï¼Œtaro-cli å·¥ç¨‹çš„æ–‡ä»¶å¹¶ä¸ç®—å¤šï¼Œä¸»è¦ç›®å½•æœ‰ï¼š/binã€/srcã€/template</p>
</blockquote>
<h3 id="4-2-ç”¨åˆ°çš„æ ¸å¿ƒåº“"><a href="#4-2-ç”¨åˆ°çš„æ ¸å¿ƒåº“" class="headerlink" title="4.2 ç”¨åˆ°çš„æ ¸å¿ƒåº“"></a>4.2 ç”¨åˆ°çš„æ ¸å¿ƒåº“</h3><ul>
<li>tj/commander.js Node.js - å‘½ä»¤è¡Œæ¥å£å…¨é¢çš„è§£å†³æ–¹æ¡ˆ</li>
<li>jprichardson/node-fs-extra - åœ¨ Node.js çš„ fs åŸºç¡€ä¸Šå¢åŠ äº†ä¸€äº›æ–°çš„æ–¹æ³•ï¼Œæ›´å¥½ç”¨ï¼Œè¿˜å¯ä»¥æ‹·è´æ¨¡æ¿ã€‚</li>
<li>chalk/chalk - å¯ä»¥ç”¨äºæ§åˆ¶ç»ˆç«¯è¾“å‡ºå­—ç¬¦ä¸²çš„æ ·å¼</li>
<li>SBoudrias/Inquirer.js - Node.js å‘½ä»¤è¡Œäº¤äº’å·¥å…·ï¼Œé€šç”¨çš„å‘½ä»¤è¡Œç”¨æˆ·ç•Œé¢é›†åˆï¼Œå¯ä»¥å’Œç”¨æˆ·è¿›è¡Œäº¤äº’</li>
<li>sindresorhus/ora - å®ç°åŠ è½½ä¸­çš„çŠ¶æ€æ˜¯ä¸€ä¸ª Loading åŠ å‰é¢è½¬èµ·æ¥çš„å°åœˆåœˆï¼ŒæˆåŠŸäº†æ˜¯ä¸€ä¸ª Success åŠ å‰é¢ä¸€ä¸ªå°é’©é’©</li>
<li>SBoudrias/mem-fs-editor - æä¾›ä¸€ç³»åˆ— APIï¼Œæ–¹ä¾¿æ“ä½œæ¨¡æ¿æ–‡ä»¶</li>
<li>shelljs/shelljs - ShellJS æ˜¯ Node.js æ‰©å±•ï¼Œç”¨äºå®ç° Unix shell å‘½ä»¤æ‰§è¡Œã€‚</li>
</ul>
<h3 id="4-3-Taro-Init"><a href="#4-3-Taro-Init" class="headerlink" title="4.3 Taro Init"></a>4.3 Taro Init</h3><p><img src= "/img/loading.gif" data-src="https://m.360buyimg.com/img/jfs/t1/88040/24/7314/51974/5dfb311bEef964024/24ef0e40d268b7fc.png"></p>
<blockquote>
<p>å½“æˆ‘ä»¬å…¨å±€å®‰è£… taro-cli åŒ…ä¹‹åï¼Œæˆ‘ä»¬çš„å‘½ä»¤è¡Œé‡Œå°±æœ‰äº† Taro å‘½ä»¤</p>
</blockquote>
<ul>
<li>é‚£ä¹ˆ Taro å‘½ä»¤æ˜¯æ€æ ·æ·»åŠ è¿›å»çš„å‘¢ï¼Ÿå…¶åŸå› åœ¨äº package.json é‡Œé¢çš„ bin å­—æ®µï¼š</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;bin&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;taro&quot;</span>: <span class="string">&quot;bin/taro&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸Šé¢ä»£ç æŒ‡å®šï¼ŒTaro å‘½ä»¤å¯¹åº”çš„å¯æ‰§è¡Œæ–‡ä»¶ä¸º bin/taro ã€‚NPM ä¼šå¯»æ‰¾è¿™ä¸ªæ–‡ä»¶ï¼Œåœ¨ [prefix]/bin ç›®å½•ä¸‹å»ºç«‹ç¬¦å·é“¾æ¥ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼ŒTaro ä¼šå»ºç«‹ç¬¦å·é“¾æ¥ [prefix]/bin/taroã€‚ç”±äº [prefix]/bin ç›®å½•ä¼šåœ¨è¿è¡Œæ—¶åŠ å…¥ç³»ç»Ÿçš„ PATH å˜é‡ï¼Œå› æ­¤åœ¨è¿è¡Œ NPM æ—¶ï¼Œå°±å¯ä»¥ä¸å¸¦è·¯å¾„ï¼Œç›´æ¥é€šè¿‡å‘½ä»¤æ¥è°ƒç”¨è¿™äº›è„šæœ¬ã€‚</p>
<ul>
<li>å…³äº prefixï¼Œå¯ä»¥é€šè¿‡ npm config get prefix è·å–ã€‚</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ npm config get prefix</span><br><span class="line">/usr/local</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä¸‹åˆ—å‘½ä»¤å¯ä»¥æ›´åŠ æ¸…æ™°çš„çœ‹åˆ°å®ƒä»¬ä¹‹é—´çš„ç¬¦å·é“¾æ¥â€¦</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ ls -al <span class="string">`which taro`</span></span><br><span class="line">lrwxr-xr-x  <span class="number">1</span> chengshuai  admin  <span class="number">40</span>  <span class="number">6</span> <span class="number">15</span> <span class="number">10</span>:<span class="number">51</span> /usr/local/bin/taro -&gt; ../lib/node_modules/@tarojs/cli/bin/taro...</span><br></pre></td></tr></table></figure>

<h4 id="4-3-1-å‘½ä»¤å…³è”ä¸å‚æ•°è§£æ"><a href="#4-3-1-å‘½ä»¤å…³è”ä¸å‚æ•°è§£æ" class="headerlink" title="4.3.1 å‘½ä»¤å…³è”ä¸å‚æ•°è§£æ"></a>4.3.1 å‘½ä»¤å…³è”ä¸å‚æ•°è§£æ</h4><blockquote>
<p>è¿™é‡Œå°±ä¸å¾—ä¸æåˆ°ä¸€ä¸ªæœ‰ç”¨çš„åŒ…ï¼štj/commander.js ï¼ŒNode.js å‘½ä»¤è¡Œæ¥å£å…¨é¢çš„è§£å†³æ–¹æ¡ˆï¼Œçµæ„Ÿæ¥è‡ªäº Rubyâ€™s commanderã€‚å¯ä»¥è‡ªåŠ¨çš„è§£æå‘½ä»¤å’Œå‚æ•°ï¼Œåˆå¹¶å¤šé€‰é¡¹ï¼Œå¤„ç†çŸ­å‚ç­‰ç­‰ï¼ŒåŠŸèƒ½å¼ºå¤§ï¼Œä¸Šæ‰‹ç®€å•</p>
</blockquote>
<p>æ›´ä¸»è¦çš„ï¼Œcommander æ”¯æŒ Git é£æ ¼çš„å­å‘½ä»¤å¤„ç†ï¼Œå¯ä»¥æ ¹æ®å­å‘½ä»¤è‡ªåŠ¨å¼•å¯¼åˆ°ä»¥ç‰¹å®šæ ¼å¼å‘½åçš„å‘½ä»¤æ‰§è¡Œæ–‡ä»¶ï¼Œæ–‡ä»¶åçš„æ ¼å¼æ˜¯ [command]-[subcommand]ï¼Œä¾‹å¦‚</p>
<ul>
<li>taro init =&gt; taro-init</li>
<li>taro build =&gt; taro-build</li>
<li>/bin/taro æ–‡ä»¶å†…å®¹ä¸å¤šï¼Œæ ¸å¿ƒä»£ç ä¹Ÿå°±é‚£å‡ è¡Œ .command() å‘½ä»¤ï¼š</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /usr/bin/env node</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> program = <span class="built_in">require</span>(<span class="string">&#x27;commander&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> &#123;getPkgVersion&#125; = <span class="built_in">require</span>(<span class="string">&#x27;../src/util&#x27;</span>)</span><br><span class="line"></span><br><span class="line">program</span><br><span class="line">  .version(getPkgVersion())</span><br><span class="line">  .usage(<span class="string">&#x27;&lt;command&gt; [options]&#x27;</span>)</span><br><span class="line">  .command(<span class="string">&#x27;init [projectName]&#x27;</span>, <span class="string">&#x27;Init a project with default templete&#x27;</span>)</span><br><span class="line">  .command(<span class="string">&#x27;build&#x27;</span>, <span class="string">&#x27;Build a project with options&#x27;</span>)</span><br><span class="line">  .command(<span class="string">&#x27;update&#x27;</span>, <span class="string">&#x27;Update packages of taro&#x27;</span>)</span><br><span class="line">  .parse(process.argv)...</span><br></pre></td></tr></table></figure>

<blockquote>
<p>é€šè¿‡ä¸Šé¢ä»£ç å¯ä»¥å‘ç°ï¼Œinitï¼Œbuild ï¼Œupdate ç­‰å‘½ä»¤éƒ½æ˜¯é€šè¿‡.command(name, description)æ–¹æ³•å®šä¹‰çš„ï¼Œç„¶åé€šè¿‡ .parse(arg) æ–¹æ³•è§£æå‚æ•°</p>
</blockquote>
<h4 id="4-3-2-å‚æ•°è§£æåŠä¸ç”¨æˆ·äº¤äº’"><a href="#4-3-2-å‚æ•°è§£æåŠä¸ç”¨æˆ·äº¤äº’" class="headerlink" title="4.3.2 å‚æ•°è§£æåŠä¸ç”¨æˆ·äº¤äº’"></a>4.3.2 å‚æ•°è§£æåŠä¸ç”¨æˆ·äº¤äº’</h4><ul>
<li>commander åŒ…å¯ä»¥è‡ªåŠ¨è§£æå‘½ä»¤å’Œå‚æ•°ï¼Œåœ¨é…ç½®å¥½å‘½ä»¤ä¹‹åï¼Œè¿˜èƒ½å¤Ÿè‡ªåŠ¨ç”Ÿæˆ helpï¼ˆå¸®åŠ©ï¼‰å‘½ä»¤å’Œ versionï¼ˆç‰ˆæœ¬æŸ¥çœ‹ï¼‰ å‘½ä»¤ã€‚å¹¶ä¸”é€šè¿‡ program.args ä¾¿å¯ä»¥è·å–å‘½ä»¤è¡Œçš„å‚æ•°ï¼Œç„¶åå†æ ¹æ®å‚æ•°æ¥è°ƒç”¨ä¸åŒçš„è„šæœ¬ã€‚</li>
<li>ä½†å½“æˆ‘ä»¬è¿è¡Œ taro init å‘½ä»¤åï¼Œå¦‚ä¸‹æ‰€ç¤ºçš„å‘½ä»¤è¡Œäº¤äº’åˆæ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿâ€¦</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ taro init taroDemo</span><br><span class="line">Taro å³å°†åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®!</span><br><span class="line">Need help? Go and open issue: https:<span class="comment">//github.com/NervJS/taro/issues/new</span></span><br><span class="line"></span><br><span class="line">Taro v0<span class="number">.0</span><span class="number">.50</span></span><br><span class="line"></span><br><span class="line">? è¯·è¾“å…¥é¡¹ç›®ä»‹ç»ï¼</span><br><span class="line">? è¯·é€‰æ‹©æ¨¡æ¿ é»˜è®¤æ¨¡æ¿...</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œä½¿ç”¨çš„æ˜¯ SBoudrias/Inquirer.js æ¥å¤„ç†å‘½ä»¤è¡Œäº¤äº’ã€‚</p>
<p>ç”¨æ³•å…¶å®å¾ˆç®€å•</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> inquirer = <span class="built_in">require</span>(<span class="string">&#x27;inquirer&#x27;</span>)  <span class="comment">// npm i inquirer -D</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> conf.description !== <span class="string">&#x27;string&#x27;</span>) &#123;</span><br><span class="line">      prompts.push(&#123;</span><br><span class="line">        type: <span class="string">&#x27;input&#x27;</span>,</span><br><span class="line">        name: <span class="string">&#x27;description&#x27;</span>,</span><br><span class="line">        message: <span class="string">&#x27;è¯·è¾“å…¥é¡¹ç›®ä»‹ç»ï¼&#x27;</span></span><br><span class="line">      &#125;)</span><br><span class="line">&#125;...</span><br></pre></td></tr></table></figure>

<ul>
<li>prompt()æ¥å—ä¸€ä¸ªé—®é¢˜å¯¹è±¡çš„æ•°æ®ï¼Œåœ¨ç”¨æˆ·ä¸ç»ˆç«¯äº¤äº’è¿‡ç¨‹ä¸­ï¼Œå°†ç”¨æˆ·çš„è¾“å…¥å­˜æ”¾åœ¨ä¸€ä¸ªç­”æ¡ˆå¯¹è±¡ä¸­ï¼Œç„¶åè¿”å›ä¸€ä¸ª Promiseï¼Œé€šè¿‡ then()è·å–åˆ°è¿™ä¸ªç­”æ¡ˆå¯¹è±¡ã€‚<br>å€Ÿæ­¤ï¼Œæ–°é¡¹ç›®çš„åç§°ã€ç‰ˆæœ¬å·ã€æè¿°ç­‰ä¿¡æ¯å¯ä»¥ç›´æ¥é€šè¿‡ç»ˆç«¯äº¤äº’æ’å…¥åˆ°é¡¹ç›®æ¨¡æ¿ä¸­ï¼Œå®Œå–„äº¤äº’æµç¨‹ã€‚</li>
<li>å½“ç„¶ï¼Œäº¤äº’çš„é—®é¢˜ä¸ä»…é™äºæ­¤ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±é¡¹ç›®çš„æƒ…å†µï¼Œæ·»åŠ æ›´å¤šçš„äº¤äº’é—®é¢˜ã€‚inquirer.js å¼ºå¤§çš„åœ°æ–¹åœ¨äºï¼Œæ”¯æŒå¾ˆå¤šç§äº¤äº’ç±»å‹ï¼Œé™¤äº†ç®€å•çš„ inputï¼Œè¿˜æœ‰ confirmã€listã€passwordã€checkbox ç­‰ï¼Œå…·ä½“å¯ä»¥å‚è§é¡¹ç›®çš„å·¥ç¨‹ READMEã€‚<br>æ­¤å¤–ï¼Œä½ åœ¨æ‰§è¡Œå¼‚æ­¥æ“ä½œçš„è¿‡ç¨‹ä¸­ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ sindresorhus/ora æ¥æ·»åŠ ä¸€ä¸‹ Loading æ•ˆæœã€‚ä½¿ç”¨ chalk/chalk ç»™ç»ˆç«¯çš„è¾“å‡ºæ·»åŠ å„ç§æ ·å¼â€¦</li>
</ul>
<h4 id="4-3-3-æ¨¡ç‰ˆæ–‡ä»¶æ“ä½œ"><a href="#4-3-3-æ¨¡ç‰ˆæ–‡ä»¶æ“ä½œ" class="headerlink" title="4.3.3 æ¨¡ç‰ˆæ–‡ä»¶æ“ä½œ"></a>4.3.3 æ¨¡ç‰ˆæ–‡ä»¶æ“ä½œ</h4><p>æœ€åå°±æ˜¯æ¨¡ç‰ˆæ–‡ä»¶æ“ä½œäº†ï¼Œä¸»è¦åˆ†ä¸ºä¸¤å¤§å—ï¼š</p>
<ul>
<li>å°†è¾“å…¥çš„å†…å®¹æ’å…¥åˆ°æ¨¡æ¿ä¸­</li>
<li>æ ¹æ®å‘½ä»¤åˆ›å»ºå¯¹åº”ç›®å½•ç»“æ„ï¼Œcopy æ–‡ä»¶</li>
<li>æ›´æ–°å·²å­˜åœ¨æ–‡ä»¶å†…å®¹</li>
</ul>
<blockquote>
<p>è¿™äº›æ“ä½œåŸºæœ¬éƒ½æ˜¯åœ¨ /template/index.js æ–‡ä»¶é‡Œã€‚<br>è¿™é‡Œè¿˜ç”¨åˆ°äº† shelljs/shelljs æ‰§è¡Œ shell è„šæœ¬ï¼Œå¦‚åˆå§‹åŒ– Gitï¼š git initï¼Œé¡¹ç›®åˆå§‹åŒ–ä¹‹åå®‰è£…ä¾èµ– npm install ç­‰</p>
</blockquote>
<p>æ‹·è´æ¨¡æ¿æ–‡ä»¶</p>
<p>æ‹·è´æ¨¡ç‰ˆæ–‡ä»¶ä¸»è¦æ˜¯ä½¿ç”¨ jprichardson/node-fs-extra çš„ copyTpl()æ–¹æ³•ï¼Œæ­¤æ–¹æ³•ä½¿ç”¨ ejs æ¨¡æ¿è¯­æ³•ï¼Œå¯ä»¥å°†è¾“å…¥çš„å†…å®¹æ’å…¥åˆ°æ¨¡ç‰ˆçš„å¯¹åº”ä½ç½®ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.fs.copyTpl(</span><br><span class="line">  project,</span><br><span class="line">  path.join(projectPath, <span class="string">&#x27;project.config.json&#x27;</span>),</span><br><span class="line">  &#123;description, projectName&#125;</span><br><span class="line">);...</span><br></pre></td></tr></table></figure>

<h3 id="4-4-Taro-Build"><a href="#4-4-Taro-Build" class="headerlink" title="4.4 Taro Build"></a>4.4 Taro Build</h3><ul>
<li>taro build å‘½ä»¤æ˜¯æ•´ä¸ª Taro é¡¹ç›®çš„çµé­‚å’Œæ ¸å¿ƒï¼Œä¸»è¦è´Ÿè´£å¤šç«¯ä»£ç ç¼–è¯‘ï¼ˆH5ï¼Œå°ç¨‹åºï¼ŒReact Native ç­‰ï¼‰ã€‚</li>
<li>Taro å‘½ä»¤çš„å…³è”ï¼Œå‚æ•°è§£æç­‰å’Œ taro init å…¶å®æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼Œé‚£ä¹ˆæœ€å…³é”®çš„ä»£ç è½¬æ¢éƒ¨åˆ†æ˜¯æ€æ ·å®ç°çš„å‘¢ï¼Ÿâ€¦</li>
</ul>
<h4 id="4-4-1-ç¼–è¯‘å·¥ä½œæµä¸æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰"><a href="#4-4-1-ç¼–è¯‘å·¥ä½œæµä¸æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰" class="headerlink" title="4.4.1 ç¼–è¯‘å·¥ä½œæµä¸æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰"></a>4.4.1 ç¼–è¯‘å·¥ä½œæµä¸æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰</h4><blockquote>
<p>Taro çš„æ ¸å¿ƒéƒ¨åˆ†å°±æ˜¯å°†ä»£ç ç¼–è¯‘æˆå…¶ä»–ç«¯ï¼ˆH5ã€å°ç¨‹åºã€React Native ç­‰ï¼‰ä»£ç ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œå°†ä¸€ç§ç»“æ„åŒ–è¯­è¨€çš„ä»£ç ç¼–è¯‘æˆå¦ä¸€ç§ç±»ä¼¼çš„ç»“æ„åŒ–è¯­è¨€çš„ä»£ç åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤</p>
</blockquote>
<p><img src= "/img/loading.gif" data-src="https://m.360buyimg.com/img/jfs/t1/96906/16/7374/30011/5dfb338eE70cc9fd9/efe8147142d6aa89.png"></p>
<p>é¦–å…ˆæ˜¯ Parseï¼Œå°†ä»£ç è§£æï¼ˆParseï¼‰æˆæŠ½è±¡è¯­æ³•æ ‘ï¼ˆAbstract Syntex Treeï¼‰ï¼Œç„¶åå¯¹ AST è¿›è¡Œéå†ï¼ˆtraverseï¼‰å’Œæ›¿æ¢(replace)ï¼ˆè¿™å¯¹äºå‰ç«¯æ¥è¯´å…¶å®å¹¶ä¸é™Œç”Ÿï¼Œå¯ä»¥ç±»æ¯” DOM æ ‘çš„æ“ä½œï¼‰ï¼Œæœ€åæ˜¯ç”Ÿæˆï¼ˆgenerateï¼‰ï¼Œæ ¹æ®æ–°çš„ AST ç”Ÿæˆç¼–è¯‘åçš„ä»£ç â€¦</p>
<h4 id="4-4-2-Babel-æ¨¡å—"><a href="#4-4-2-Babel-æ¨¡å—" class="headerlink" title="4.4.2 Babel æ¨¡å—"></a>4.4.2 Babel æ¨¡å—</h4><p>Babel æ˜¯ä¸€ä¸ªé€šç”¨çš„å¤šåŠŸèƒ½çš„ JavaScript ç¼–è¯‘å™¨ï¼Œæ›´ç¡®åˆ‡åœ°è¯´æ˜¯æºç åˆ°æºç çš„ç¼–è¯‘å™¨ï¼Œé€šå¸¸ä¹Ÿå«åšè½¬æ¢ç¼–è¯‘å™¨ï¼ˆtranspilerï¼‰ã€‚ æ„æ€æ˜¯è¯´ä½ ä¸º Babel æä¾›ä¸€äº› JavaScript ä»£ç ï¼ŒBabel æ›´æ”¹è¿™äº›ä»£ç ï¼Œç„¶åè¿”å›ç»™ä½ æ–°ç”Ÿæˆçš„ä»£ç â€¦</p>
<h4 id="4-4-3-è§£æé¡µé¢-Config-é…ç½®"><a href="#4-4-3-è§£æé¡µé¢-Config-é…ç½®" class="headerlink" title="4.4.3 è§£æé¡µé¢ Config é…ç½®"></a>4.4.3 è§£æé¡µé¢ Config é…ç½®</h4><blockquote>
<p>åœ¨ä¸šåŠ¡ä»£ç ç¼–è¯‘æˆå°ç¨‹åºçš„ä»£ç è¿‡ç¨‹ä¸­ï¼Œæœ‰ä¸€æ­¥æ˜¯å°†é¡µé¢å…¥å£ JS çš„ Config å±æ€§è§£æå‡ºæ¥ï¼Œå¹¶å†™å…¥ *.json æ–‡ä»¶ï¼Œä¾›å°ç¨‹åºä½¿ç”¨ã€‚é‚£ä¹ˆè¿™ä¸€æ­¥æ˜¯æ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿè¿™é‡Œå°†è¿™éƒ¨åˆ†åŠŸèƒ½çš„å…³é”®ä»£ç æŠ½å–å‡ºæ¥ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. babel-traverseæ–¹æ³•ï¼Œ éå†å’Œæ›´æ–°èŠ‚ç‚¹</span></span><br><span class="line">traverse(ast, &#123;</span><br><span class="line">  <span class="function"><span class="title">ClassProperty</span>(<span class="params">astPath</span>)</span> &#123; <span class="comment">// éå†ç±»çš„å±æ€§å£°æ˜</span></span><br><span class="line">    <span class="keyword">const</span> node = astPath.node</span><br><span class="line">    <span class="keyword">if</span> (node.key.name === <span class="string">&#x27;config&#x27;</span>) &#123; <span class="comment">// ç±»çš„å±æ€§åä¸º config</span></span><br><span class="line">      configObj = traverseObjectNode(node)</span><br><span class="line">      astPath.remove() <span class="comment">// å°†è¯¥æ–¹æ³•ç§»é™¤æ‰</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. éå†ï¼Œè§£æä¸º JSON å¯¹è±¡</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">traverseObjectNode</span>(<span class="params">node, obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (node.type === <span class="string">&#x27;ClassProperty&#x27;</span> || node.type === <span class="string">&#x27;ObjectProperty&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> properties = node.value.properties</span><br><span class="line">      obj = &#123;&#125;</span><br><span class="line">      properties.forEach(<span class="function">(<span class="params">p, index</span>) =&gt;</span> &#123;</span><br><span class="line">        obj[p.key.name] = traverseObjectNode(p.value)</span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="keyword">return</span> obj</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (node.type === <span class="string">&#x27;ObjectExpression&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> properties = node.properties</span><br><span class="line">    obj = &#123;&#125;</span><br><span class="line">    properties.forEach(<span class="function">(<span class="params">p, index</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// const t = require(&#x27;babel-types&#x27;)  AST èŠ‚ç‚¹çš„ Lodash å¼å·¥å…·åº“</span></span><br><span class="line">      <span class="keyword">const</span> key = t.isIdentifier(p.key) ? p.key.name : p.key.value</span><br><span class="line">      obj[key] = traverseObjectNode(p.value)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">return</span> obj</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (node.type === <span class="string">&#x27;ArrayExpression&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> node.elements.map(<span class="function"><span class="params">item</span> =&gt;</span> traverseObjectNode(item))</span><br><span class="line"> ...</span><br></pre></td></tr></table></figure>

<h2 id="äº”ã€Taro-ç»„ä»¶åº“åŠ-API-çš„è®¾è®¡ä¸é€‚é…"><a href="#äº”ã€Taro-ç»„ä»¶åº“åŠ-API-çš„è®¾è®¡ä¸é€‚é…" class="headerlink" title="äº”ã€Taro ç»„ä»¶åº“åŠ API çš„è®¾è®¡ä¸é€‚é…"></a>äº”ã€Taro ç»„ä»¶åº“åŠ API çš„è®¾è®¡ä¸é€‚é…</h2><h3 id="5-1-å¤šç«¯å·®å¼‚"><a href="#5-1-å¤šç«¯å·®å¼‚" class="headerlink" title="5.1 å¤šç«¯å·®å¼‚"></a>5.1 å¤šç«¯å·®å¼‚</h3><h4 id="5-1-1-ç»„ä»¶å·®å¼‚"><a href="#5-1-1-ç»„ä»¶å·®å¼‚" class="headerlink" title="5.1.1 ç»„ä»¶å·®å¼‚"></a>5.1.1 ç»„ä»¶å·®å¼‚</h4><p>å°ç¨‹åºã€H5 ä»¥åŠå¿«åº”ç”¨éƒ½å¯ä»¥åˆ’åˆ†ä¸º XML ç±»ï¼ŒReact Native å½’ä¸º JSX ç±»ï¼Œä¸¤ç§è¯­è¨€é£ç‰›é©¬ä¸ç›¸åŠï¼Œç»™é€‚é…è®¾ç½®äº†éå¸¸å¤§çš„éšœç¢ã€‚XML ç±»æœ‰ä¸ªæ˜æ˜¾çš„ç‰¹ç‚¹æ˜¯å…³æ³¨ç‚¹åˆ†ç¦»ï¼ˆSeparation of Concernsï¼‰ï¼Œå³è¯­ä¹‰å±‚ï¼ˆXMLï¼‰ã€è§†è§‰å±‚ï¼ˆCSSï¼‰ã€äº¤äº’å±‚ï¼ˆJavaScriptï¼‰ä¸‰è€…åˆ†ç¦»çš„æ¾è€¦åˆå½¢å¼ï¼ŒJSX ç±»åˆ™è¦æŠŠä¸‰è€…æ··ä¸ºä¸€ä½“ï¼Œç”¨è„šæœ¬æ¥åŒ…æ½ä¸‰è€…çš„å·¥ä½œâ€¦</p>
<p>ä¸åŒç«¯çš„ç»„ä»¶çš„å·®å¼‚è¿˜ä½“ç°åœ¨å®šåˆ¶ç¨‹åº¦ä¸Š</p>
<ul>
<li>H5 æ ‡ç­¾ï¼ˆç»„ä»¶ï¼‰æä¾›æœ€åŸºç¡€çš„åŠŸèƒ½â€”â€”å¸ƒå±€ã€è¡¨å•ã€åª’ä½“ã€å›¾å½¢ç­‰ç­‰ï¼›</li>
<li>å°ç¨‹åºç»„ä»¶ç›¸å¯¹ H5 æœ‰äº†ä¸€å®šç¨‹åº¦çš„å®šåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå°ç¨‹åºç»„ä»¶çœ‹ä½œä¸€å¥—ç±»ä¼¼äº H5 çš„ UI ç»„ä»¶åº“ï¼›</li>
<li>React Native ç«¯ç»„ä»¶ä¹ŸåŒæ ·å¦‚æ­¤ï¼Œè€Œä¸”åŸºæœ¬æ˜¯ä¸“â€œç»„â€ä¸“ç”¨çš„ï¼Œæ¯”å¦‚è¦è§¦å‘ç‚¹å‡»äº‹ä»¶å°±å¾—ç”¨ Touchable æˆ–è€… Text ç»„ä»¶ï¼Œè¦æ¸²æŸ“æ–‡æœ¬å°±å¾—ç”¨ Text ç»„ä»¶ï¼ˆè™½ç„¶å°ç¨‹åºä¹Ÿæä¾›äº† Text ç»„ä»¶ï¼Œä½†å®ƒçš„æ–‡æœ¬ä»ç„¶å¯ä»¥ç›´æ¥æ”¾åˆ° view ä¹‹ç±»çš„ç»„ä»¶é‡Œï¼‰â€¦</li>
</ul>
<h4 id="5-1-2-API-å·®å¼‚"><a href="#5-1-2-API-å·®å¼‚" class="headerlink" title="5.1.2 API å·®å¼‚"></a>5.1.2 API å·®å¼‚</h4><p>å„ç«¯ API çš„å·®å¼‚å…·æœ‰å®šåˆ¶åŒ–ã€æ¥å£ä¸ä¸€ã€èƒ½åŠ›é™åˆ¶çš„ç‰¹ç‚¹</p>
<ul>
<li>å®šåˆ¶åŒ–ï¼šå„ç«¯æ‰€æä¾›çš„ API éƒ½æ˜¯ç»è¿‡é‡èº«æ‰“é€ çš„ï¼Œæ¯”å¦‚å°ç¨‹åºçš„å¼€æ”¾æ¥å£ç±» APIï¼Œå®Œå…¨æ˜¯é’ˆå¯¹å°ç¨‹åºæ‰€å¤„çš„å¾®ä¿¡ç¯å¢ƒæ‰“é€ çš„ï¼Œå…¶æä¾›çš„åŠŸèƒ½ä»¥åŠå¤–åœ¨è¡¨ç°éƒ½å·²ç”±æ¡†æ¶æä¾›å®ç°ï¼Œç”¨æˆ·ä¸Šæ‰‹å¯ç”¨ï¼Œæ¯‹é¡»å…³å¿ƒå†…éƒ¨å®ç°ã€‚</li>
<li>æ¥å£ä¸ä¸€ï¼šç›¸åŒçš„åŠŸèƒ½ï¼Œåœ¨ä¸åŒç«¯ä¸‹çš„è°ƒç”¨æ–¹å¼ä»¥åŠè°ƒç”¨å‚æ•°ç­‰ä¹Ÿä¸ä¸€æ ·ï¼Œæ¯”å¦‚ socketï¼Œå°ç¨‹åºä¸­ç”¨ wx.connectSocket æ¥è¿æ¥ï¼ŒH5 åˆ™ç”¨ new WebSocket() æ¥è¿æ¥ï¼Œè¿™æ ·çš„ä¾‹å­æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°å¾ˆå¤šä¸ªã€‚</li>
<li>èƒ½åŠ›é™åˆ¶ï¼šå„ç«¯ä¹‹é—´çš„å·®å¼‚å¯ä»¥è¿›è¡Œå®šåˆ¶é€‚é…ï¼Œç„¶è€Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ APIï¼ˆæ­¤å¤„ç‰¹æŒ‡å°ç¨‹åº APIï¼Œå› ä¸ºå¤šç«¯é€‚é…æ˜¯å‘å°ç¨‹åºçœ‹é½çš„ï¼‰åœ¨å„ä¸ªç«¯éƒ½èƒ½é€šè¿‡å®šåˆ¶é€‚é…æ¥å®ç°ï¼Œå› ä¸ºä¸åŒç«¯æ‰€èƒ½æä¾›çš„ç«¯èƒ½åŠ›â€œå¤§å¼‚å°åŒâ€ï¼Œè¿™æ˜¯åœ¨é€‚é…è¿‡ç¨‹ä¸­ä¸å¯æŠ—æ‹’ã€ä¸å¯æŠ¹å¹³çš„å·®å¼‚â€¦</li>
</ul>
<h3 id="5-2-å¤šç«¯é€‚é…"><a href="#5-2-å¤šç«¯é€‚é…" class="headerlink" title="5.2 å¤šç«¯é€‚é…"></a>5.2 å¤šç«¯é€‚é…</h3><h4 id="5-2-1-æ ·å¼å¤„ç†"><a href="#5-2-1-æ ·å¼å¤„ç†" class="headerlink" title="5.2.1 æ ·å¼å¤„ç†"></a>5.2.1 æ ·å¼å¤„ç†</h4><p>H5 ç«¯ä½¿ç”¨å®˜æ–¹æä¾›çš„ WEUI è¿›è¡Œé€‚é…ï¼ŒReact Native ç«¯åˆ™åœ¨ç»„ä»¶å†…æ·»åŠ æ ·å¼ï¼Œå¹¶é€šè¿‡è„šæœ¬æ¥æ§åˆ¶ä¸€äº›çŠ¶æ€ç±»çš„æ ·å¼ï¼Œæ¡†æ¶æ ¸å¿ƒåœ¨ç¼–è¯‘çš„æ—¶å€™æŠŠæºä»£ç çš„ class æ‰€æŒ‡å‘çš„æ ·å¼é€šè¿‡ css-to-react-native è¿›è¡Œè½¬è¯‘ï¼Œæ‰€å¾— StyleSheet æ ·å¼ä¼ å…¥ç»„ä»¶çš„ style å‚æ•°ï¼Œç»„ä»¶å†…éƒ¨ä¼šå¯¹æ ·å¼è¿›è¡ŒäºŒæ¬¡å¤„ç†ï¼Œå¾—åˆ°æœ€ç»ˆçš„æ ·å¼â€¦</p>
<p><img src= "/img/loading.gif" data-src="https://m.360buyimg.com/img/jfs/t1/104718/12/7499/47989/5dfb3fedE9cfe19c7/d29edbfd298253d4.png"></p>
<p>ä¸ºä»€ä¹ˆéœ€è¦å¯¹æ ·å¼è¿›è¡ŒäºŒæ¬¡å¤„ç†ï¼Ÿ</p>
<blockquote>
<p>éƒ¨åˆ†ç»„ä»¶æ˜¯ç›´æ¥æŠŠä¼ å…¥ style çš„æ ·å¼èµ‹ç»™æœ€å¤–å±‚çš„ React Native åŸç”Ÿç»„ä»¶ï¼Œä½†éƒ¨åˆ†ç»è¿‡å±‚å±‚å°è£…çš„ç»„ä»¶åˆ™ä¸ç„¶ï¼Œæˆ‘ä»¬è¦æŠŠå®¹å™¨æ ·å¼ã€å†…éƒ¨æ ·å¼å’Œæ–‡æœ¬æ ·å¼ç¦»æã€‚ä¸ºäº†æ–¹ä¾¿è§£é‡Šï¼Œæˆ‘ä»¬æŠŠè¿™ç±»ç»„ä»¶ç®€åŒ–ä¸ºä»¥ä¸‹çš„å½¢å¼ï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;View style=&#123;wrapperStyle&#125;&gt;</span><br><span class="line">  &lt;View style=&#123;containerStyle&#125;&gt;</span><br><span class="line">    &lt;Text style=&#123;textStyle&#125;&gt;Hello World&lt;/Text&gt;</span><br><span class="line">  &lt;/View&gt;</span><br><span class="line">&lt;/View&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å‡è®¾ç»„ä»¶æœ‰æ ·å¼ margin-topã€background-color å’Œ font-sizeï¼Œè½¬è¯‘ä¼ å…¥ç»„ä»¶åï¼Œå°±è¦æŠŠåˆ†åˆ«æŠŠå®ƒä»¬ä¼ åˆ° wrapperStyleã€containerStyle å’Œ textStyleï¼Œå¯å‚è€ƒ ScrollView çš„ style å’Œ contentContainerStyleâ€¦</p>
</blockquote>
<h4 id="5-2-2-ç»„ä»¶å°è£…"><a href="#5-2-2-ç»„ä»¶å°è£…" class="headerlink" title="5.2.2 ç»„ä»¶å°è£…"></a>5.2.2 ç»„ä»¶å°è£…</h4><blockquote>
<p>ç»„ä»¶çš„å°è£…åˆ™æ˜¯ä¸€ä¸ªâ€œä»¿åˆ¶â€çš„è¿‡ç¨‹ï¼Œåˆ©ç”¨ç«¯æä¾›çš„åŸææ–™ï¼ŒåŠ å·¥æˆé€šç”¨çš„ç»„ä»¶ï¼Œæš´éœ²ç›¸å¯¹ç»Ÿä¸€çš„è°ƒç”¨æ–¹å¼ã€‚æˆ‘ä»¬ç”¨ <Button /> è¿™ä¸ªç»„ä»¶æ¥ä¸¾ä¾‹ï¼Œåœ¨å°ç¨‹åºç«¯å®ƒä¹Ÿè®¸æ˜¯é•¿è¿™æ ·å­çš„</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;button</span><br><span class="line">  size=<span class="string">&quot;mini&quot;</span></span><br><span class="line">  plain=&#123;&#123; plain &#125;&#125;</span><br><span class="line">  loading=&#123;&#123; loading &#125;&#125;</span><br><span class="line">  hover-<span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;you-hover-me&quot;</span></span><br><span class="line">&gt;&lt;/button&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¦‚æœè¦å®ç° H5 ç«¯è¿™ä¹ˆä¸€ä¸ªæŒ‰é’®ï¼Œå¤§æ¦‚ä¼šåƒä¸‹é¢è¿™æ ·ï¼Œåœ¨ç»„ä»¶å†…éƒ¨æŠŠå°ç¨‹åºçš„æŒ‰é’®ç‰¹æ€§å®ç°ä¸€éï¼Œç„¶åæš´éœ²è·Ÿå°ç¨‹åºä¸€è‡´çš„è°ƒç”¨æ–¹å¼ï¼Œå°±å®Œæˆäº† H5 ç«¯ä¸€ä¸ªç»„ä»¶çš„è®¾è®¡</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;button</span><br><span class="line">  &#123;...omit(<span class="built_in">this</span>.props, [<span class="string">&#x27;hoverClass&#x27;</span>, <span class="string">&#x27;onTouchStart&#x27;</span>, <span class="string">&#x27;onTouchEnd&#x27;</span>])&#125;</span><br><span class="line">  className=&#123;cls&#125;</span><br><span class="line">  style=&#123;style&#125;</span><br><span class="line">  onClick=&#123;onClick&#125;</span><br><span class="line">  disabled=&#123;disabled&#125;</span><br><span class="line">  onTouchStart=&#123;_onTouchStart&#125;</span><br><span class="line">  onTouchEnd=&#123;_onTouchEnd&#125;</span><br><span class="line">&gt;</span><br><span class="line">  &#123;loading &amp;&amp; <span class="xml"><span class="tag">&lt;<span class="name">i</span> <span class="attr">class</span>=<span class="string">&#x27;weui-loading&#x27;</span> /&gt;</span></span>&#125;</span><br><span class="line">  &#123;children&#125;</span><br><span class="line">&lt;/button&gt;...</span><br></pre></td></tr></table></figure>

<ul>
<li>å…¶ä»–ç«¯çš„ç»„ä»¶é€‚é…ç›¸å¯¹ H5 ç«¯æ¥è¯´ä¼šæ›´æ›²æŠ˜å¤æ‚ä¸€äº›ï¼Œå› ä¸º H5 è·Ÿå°ç¨‹åºçš„è¯­è¨€è¾ƒä¸ºç›¸ä¼¼ï¼Œè€Œå…¶ä»–ç«¯éœ€è¦æ•´åˆç‰¹å®šç«¯çš„å„ç§ç»„ä»¶ï¼Œä»¥åŠåˆ©ç”¨ç«¯ç»„ä»¶çš„ç‰¹æ€§æ¥å®ç°ï¼Œæ¯”å¦‚åœ¨ React Native ä¸­å®ç°è¿™ä¸ªæŒ‰é’®ï¼Œåˆ™éœ€è¦ç”¨åˆ° &lt;Touchable* /&gt;ã€<View />ã€<Text />ï¼Œè¦å®ç°åŠ¨ç”»åˆ™éœ€è¦ç”¨ä¸Š &lt;Animated.View /&gt;ï¼Œè¿˜æœ‰å°±æ˜¯ç›¸å¯¹äº H5 å’Œå°ç¨‹åºæ¯”è¾ƒå®¹æ˜“å®ç°çš„ touch äº‹ä»¶ï¼Œåœ¨ React Native ä¸­åˆ™éœ€è¦ç”¨ä¸Š PanResponder æ¥è¿›è¡Œâ€œä»¿çœŸâ€ï¼Œæ€»ä¹‹å°±æ˜¯ï¼Œå› â€œç«¯â€åˆ¶å®œï¼Œä¸€åˆ‡ä¸ºäº†æœ€ååªéœ€ä¸€è¡Œä»£ç é€šè¡Œå¤šç«¯ï¼</li>
<li>é™¤äº†å±æ€§æ”¯æŒå¤–ï¼Œäº‹ä»¶å›è°ƒçš„å‚æ•°ä¹Ÿéœ€è¦è¿›è¡Œç»Ÿä¸€ï¼Œä¸ºæ­¤ï¼Œéœ€è¦åœ¨å†…éƒ¨è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚ Input çš„ onInput äº‹ä»¶ï¼Œéœ€è¦ç»™å®ƒé€ ä¸€ä¸ªç±»ä¼¼å°ç¨‹åºç›¸åŒäº‹ä»¶çš„å›è°ƒå‚æ•°ï¼Œæ¯”å¦‚ { target: { value: text }, detail: { value: text } }ï¼Œè¿™æ ·ï¼Œå¼€å‘è€…ä»¬å°±å¯ä»¥åƒä¸‹é¢è¿™æ ·å¤„ç†å›è°ƒäº‹ä»¶ï¼Œæ— éœ€å…³å¿ƒä¸­é—´å‘ç”Ÿäº†ä»€ä¹ˆâ€¦</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">onInputHandler</span>(<span class="params">&#123; target, detail &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(target.value, detail.value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å…­ã€JSX-è½¬æ¢å¾®ä¿¡å°ç¨‹åºæ¨¡æ¿çš„å®ç°"><a href="#å…­ã€JSX-è½¬æ¢å¾®ä¿¡å°ç¨‹åºæ¨¡æ¿çš„å®ç°" class="headerlink" title="å…­ã€JSX è½¬æ¢å¾®ä¿¡å°ç¨‹åºæ¨¡æ¿çš„å®ç°"></a>å…­ã€JSX è½¬æ¢å¾®ä¿¡å°ç¨‹åºæ¨¡æ¿çš„å®ç°</h2><h3 id="6-1-ä»£ç çš„æœ¬è´¨"><a href="#6-1-ä»£ç çš„æœ¬è´¨" class="headerlink" title="6.1 ä»£ç çš„æœ¬è´¨"></a>6.1 ä»£ç çš„æœ¬è´¨</h3><blockquote>
<p>ä¸ç®¡æ˜¯ä»»æ„è¯­è¨€çš„ä»£ç ï¼Œå…¶å®å®ƒä»¬éƒ½æœ‰ä¸¤ä¸ªå…±åŒç‚¹</p>
</blockquote>
<ul>
<li>å®ƒä»¬éƒ½æ˜¯ç”±å­—ç¬¦ä¸²æ„æˆçš„æ–‡æœ¬</li>
<li>å®ƒä»¬éƒ½è¦éµå¾ªè‡ªå·±çš„è¯­è¨€è§„èŒƒ</li>
</ul>
<p>ç¬¬ä¸€ç‚¹å¾ˆå¥½ç†è§£ï¼Œæ—¢ç„¶ä»£ç æ˜¯å­—ç¬¦ä¸²æ„æˆçš„ï¼Œæˆ‘ä»¬è¦ä¿®æ”¹/ç¼–è¯‘ä»£ç çš„æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨å­—ç¬¦ä¸²çš„å„ç§æ­£åˆ™è¡¨è¾¾å¼ã€‚ä¾‹å¦‚æˆ‘ä»¬è¦å°† JSON ä¸­ä¸€ä¸ªé”®å foo æ”¹ä¸º barï¼Œåªè¦å†™ä¸€ä¸ªç®€å•çš„æ­£åˆ™è¡¨è¾¾å¼å°±èƒ½åšåˆ°ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jsonStr.replace(<span class="regexp">/(?&lt;=&quot;)foo(?=&quot;\s*:)/i</span>, <span class="string">&#x27;bar&#x27;</span>)...</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ç¼–è¯‘å°±æ˜¯æŠŠä¸€æ®µå­—ç¬¦ä¸²æ”¹æˆå¦å¤–ä¸€æ®µå­—ç¬¦ä¸²</p>
</blockquote>
<h3 id="6-2-Babel"><a href="#6-2-Babel" class="headerlink" title="6.2 Babel"></a>6.2 Babel</h3><blockquote>
<p>JavaScript ç¤¾åŒºå…¶å®æœ‰éå¸¸å¤š parser å®ç°ï¼Œæ¯”å¦‚ Acornã€Esprimaã€Recastã€Traceurã€Cherow ç­‰ç­‰ã€‚ä½†æˆ‘ä»¬è¿˜æ˜¯é€‰æ‹©ä½¿ç”¨ Babelï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªåŸå› </p>
</blockquote>
<ul>
<li>Babel å¯ä»¥è§£æè¿˜æ²¡æœ‰è¿›å…¥ ECMAScript è§„èŒƒçš„è¯­æ³•ã€‚ä¾‹å¦‚è£…é¥°å™¨è¿™æ ·çš„ææ¡ˆï¼Œè™½ç„¶ç°åœ¨æ²¡æœ‰è¿›å…¥æ ‡å‡†ä½†æ˜¯å·²ç»å¹¿æ³›ä½¿ç”¨æœ‰ä¸€æ®µæ—¶é—´äº†ï¼›</li>
<li>Babel æä¾›æ’ä»¶æœºåˆ¶è§£æ TypeScriptã€Flowã€JSX è¿™æ ·çš„ JavaScript è¶…é›†ï¼Œä¸å¿…å•ç‹¬å¤„ç†è¿™äº›è¯­è¨€ï¼›</li>
<li>Babel æ‹¥æœ‰åºå¤§çš„ç”Ÿæ€ï¼Œæœ‰éå¸¸å¤šçš„æ–‡æ¡£å’Œæ ·ä¾‹ä»£ç å¯ä¾›å‚è€ƒï¼›</li>
<li>é™¤å» parser æœ¬èº«ï¼ŒBabel è¿˜æä¾›å„ç§æ–¹ä¾¿çš„å·¥å…·åº“å¯ä»¥ä¼˜åŒ–ã€ç”Ÿæˆã€è°ƒè¯•ä»£ç â€¦</li>
</ul>
<p>Babylonï¼ˆ @babel/parserï¼‰</p>
<blockquote>
<p>Babylon å°±æ˜¯ Babel çš„ parserã€‚å®ƒå¯ä»¥æŠŠä¸€æ®µç¬¦åˆè§„èŒƒçš„ JavaScript ä»£ç è¾“å‡ºæˆä¸€ä¸ªç¬¦åˆ Esprima è§„èŒƒçš„ ASTã€‚ å¤§éƒ¨åˆ† parser ç”Ÿæˆçš„ AST æ•°æ®ç»“æ„éƒ½éµå¾ª Esprima è§„èŒƒï¼ŒåŒ…æ‹¬ ESLint çš„ parser ESTreeã€‚è¿™å°±æ„å‘³ç€æˆ‘ä»¬ç†Ÿæ‚‰äº† Esprima è§„èŒƒçš„ AST æ•°æ®ç»“æ„è¿˜èƒ½å»å†™ ESLint æ’ä»¶</p>
</blockquote>
<p>æˆ‘ä»¬å¯ä»¥å°è¯•è§£æ n * n è¿™å¥ç®€å•çš„è¡¨è¾¾å¼ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> babylon <span class="keyword">from</span> <span class="string">&quot;babylon&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> code = <span class="string">`n * n`</span>;</span><br><span class="line">babylon.parse(code);...</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆ Babylon ä¼šè§£ææˆè¿™æ ·çš„æ•°æ®ç»“æ„ï¼š<br><img src= "/img/loading.gif" data-src="https://m.360buyimg.com/img/jfs/t1/85776/36/7301/115301/5dfb42c2Eccb38a5f/aa0004a25a7ee488.png"><br>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ ASTExploroer å¿«é€Ÿåœ°æŸ¥çœ‹ä»£ç çš„ AST</p>
<p>Babel-traverse (@babel/traverse)</p>
<blockquote>
<p>babel-traverse å¯ä»¥éå†ç”± Babylon ç”Ÿæˆçš„æŠ½è±¡è¯­æ³•æ ‘ï¼Œå¹¶æŠŠæŠ½è±¡è¯­æ³•æ ‘çš„å„ä¸ªèŠ‚ç‚¹ä»æ‹“æ‰‘æ•°æ®ç»“æ„è½¬åŒ–æˆä¸€é¢—è·¯å¾„ï¼ˆPathï¼‰æ ‘ï¼ŒPath è¡¨ç¤ºä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´è¿æ¥çš„å“åº”å¼ï¼ˆReactiveï¼‰å¯¹è±¡ï¼Œå®ƒæ‹¥æœ‰æ·»åŠ ã€åˆ é™¤ã€æ›¿æ¢èŠ‚ç‚¹ç­‰æ–¹æ³•ã€‚å½“ä½ è°ƒç”¨è¿™äº›ä¿®æ”¹æ ‘çš„æ–¹æ³•ä¹‹åï¼Œè·¯å¾„ä¿¡æ¯ä¹Ÿä¼šè¢«æ›´æ–°ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒPath è¿˜æä¾›äº†ä¸€äº›æ“ä½œä½œç”¨åŸŸï¼ˆScopeï¼‰ å’Œæ ‡è¯†ç¬¦ç»‘å®šï¼ˆIdentifier Bindingï¼‰ çš„æ–¹æ³•å¯ä»¥å»åšå¤„ç†ä¸€äº›æ›´ç²¾ç»†å¤æ‚çš„éœ€æ±‚ã€‚å¯ä»¥è¯´ babel-traverse æ˜¯ä½¿ç”¨ Babel ä½œä¸ºç¼–è¯‘å™¨æœ€æ ¸å¿ƒçš„æ¨¡å—â€¦</p>
</blockquote>
<p>è®©æˆ‘ä»¬å°è¯•ä¸€ä¸‹æŠŠä¸€æ®µä»£ç ä¸­çš„ n _ n å˜ä¸º x _ x</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> babylon <span class="keyword">from</span> <span class="string">&quot;@babel/parser&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> traverse <span class="keyword">from</span> <span class="string">&quot;babel-traverse&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> code = <span class="string">`function square(n) &#123;</span></span><br><span class="line"><span class="string">  return n * n;</span></span><br><span class="line"><span class="string">&#125;`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> ast = babylon.parse(code);</span><br><span class="line"></span><br><span class="line">traverse(ast, &#123;</span><br><span class="line">  <span class="function"><span class="title">enter</span>(<span class="params">path</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (</span><br><span class="line">      path.node.type === <span class="string">&quot;Identifier&quot;</span> &amp;&amp;</span><br><span class="line">      path.node.name === <span class="string">&quot;n&quot;</span></span><br><span class="line">    ) &#123;</span><br><span class="line">      path.node.name = <span class="string">&quot;x&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);...</span><br></pre></td></tr></table></figure>

<p>Babel-typesï¼ˆ@babel/typesï¼‰</p>
<blockquote>
<p>babel-types æ˜¯ä¸€ä¸ªç”¨äº AST èŠ‚ç‚¹çš„ Lodash å¼å·¥å…·åº“ï¼Œå®ƒåŒ…å«äº†æ„é€ ã€éªŒè¯ä»¥åŠå˜æ¢ AST èŠ‚ç‚¹çš„æ–¹æ³•ã€‚ è¯¥å·¥å…·åº“åŒ…å«è€ƒè™‘å‘¨åˆ°çš„å·¥å…·æ–¹æ³•ï¼Œå¯¹ç¼–å†™å¤„ç† AST é€»è¾‘éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚æˆ‘ä»¬ä¹‹å‰åœ¨ babel-traverse ä¸­æ”¹å˜æ ‡è¯†ç¬¦ n çš„ä»£ç å¯ä»¥ç®€å†™ä¸ºï¼š</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> traverse <span class="keyword">from</span> <span class="string">&quot;babel-traverse&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> t <span class="keyword">from</span> <span class="string">&quot;babel-types&quot;</span>;</span><br><span class="line"></span><br><span class="line">traverse(ast, &#123;</span><br><span class="line">  <span class="function"><span class="title">enter</span>(<span class="params">path</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (t.isIdentifier(path.node, &#123; <span class="attr">name</span>: <span class="string">&quot;n&quot;</span> &#125;)) &#123;</span><br><span class="line">      path.node.name = <span class="string">&quot;x&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å¯ä»¥å‘ç°ä½¿ç”¨ babel-types èƒ½æé«˜æˆ‘ä»¬è½¬æ¢ä»£ç çš„å¯è¯»æ€§ï¼Œåœ¨é…åˆ TypeScript è¿™æ ·çš„é™æ€ç±»å‹è¯­è¨€åï¼Œbabel-types çš„æ–¹æ³•è¿˜èƒ½æä¾›ç±»å‹æ ¡éªŒçš„åŠŸèƒ½ï¼Œèƒ½æœ‰æ•ˆåœ°æé«˜æˆ‘ä»¬è½¬æ¢ä»£ç çš„å¥å£®æ€§å’Œå¯é æ€§â€¦</p>
</blockquote>
<h3 id="6-3-å®è·µä¾‹å­"><a href="#6-3-å®è·µä¾‹å­" class="headerlink" title="6.3 å®è·µä¾‹å­"></a>6.3 å®è·µä¾‹å­</h3><p>ä»¥ä¸€ä¸ªç®€å• Page é¡µé¢ä¸ºä¾‹ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Taro, &#123; Component &#125; <span class="keyword">from</span> <span class="string">&#x27;@tarojs/taro&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; View, Text &#125; <span class="keyword">from</span> <span class="string">&#x27;@tarojs/components&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Home</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  config = &#123;</span><br><span class="line">    navigationBarTitleText: <span class="string">&#x27;é¦–é¡µ&#x27;</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  state = &#123;</span><br><span class="line">    numbers: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleClick = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.props.onTest()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">const</span> oddNumbers = <span class="built_in">this</span>.state.numbers.filter(<span class="function"><span class="params">number</span> =&gt;</span> number &amp; <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;ScrollView className=<span class="string">&#x27;home&#x27;</span> scrollTop=&#123;<span class="literal">false</span>&#125;&gt;</span><br><span class="line">        å¥‡æ•°ï¼š</span><br><span class="line">        &#123;</span><br><span class="line">          oddNumbers.map(<span class="function"><span class="params">number</span> =&gt;</span> <span class="xml"><span class="tag">&lt;<span class="name">Text</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>&#123;number&#125;<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span>)</span><br><span class="line">        &#125;</span><br><span class="line">        å¶æ•°ï¼š</span><br><span class="line">        &#123;</span><br><span class="line">          numbers.map(<span class="function"><span class="params">number</span> =&gt;</span> number % <span class="number">2</span> === <span class="number">0</span> &amp;&amp; <span class="xml"><span class="tag">&lt;<span class="name">Text</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>&#123;number&#125;<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span>)</span><br><span class="line">        &#125;</span><br><span class="line">      &lt;/ScrollView&gt;</span><br><span class="line">    )</span><br><span class="line">  &#125;</span><br><span class="line">&#125;...</span><br></pre></td></tr></table></figure>

<h4 id="6-3-1-è®¾è®¡æ€è·¯"><a href="#6-3-1-è®¾è®¡æ€è·¯" class="headerlink" title="6.3.1 è®¾è®¡æ€è·¯"></a>6.3.1 è®¾è®¡æ€è·¯</h4><ul>
<li>Taro çš„ç»“æ„ä¸»è¦åˆ†ä¸¤ä¸ªæ–¹é¢ï¼šè¿è¡Œæ—¶å’Œç¼–è¯‘æ—¶ã€‚è¿è¡Œæ—¶è´Ÿè´£æŠŠç¼–è¯‘ååˆ°ä»£ç è¿è¡Œåœ¨æœ¬ä¸èƒ½è¿è¡Œçš„å¯¹åº”ç¯å¢ƒä¸­ï¼Œä½ å¯ä»¥æŠŠ Taro è¿è¡Œæ—¶ç†è§£ä¸ºå‰ç«¯å¼€å‘å½“ä¸­ polyfillã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå°ç¨‹åºæ–°å»ºä¸€ä¸ªé¡µé¢æ˜¯ä½¿ç”¨ Page æ–¹æ³•ä¼ å…¥ä¸€ä¸ªå­—é¢é‡å¯¹è±¡ï¼Œå¹¶ä¸æ”¯æŒä½¿ç”¨ç±»ã€‚å¦‚æœå…¨éƒ¨ä¾èµ–ç¼–è¯‘æ—¶çš„è¯ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦åšåˆ°äº‹æƒ…å¤§æ¦‚å°±æ˜¯æŠŠç±»è½¬åŒ–æˆå¯¹è±¡ï¼ŒæŠŠ state å˜ä¸º dataï¼ŒæŠŠç”Ÿå‘½å‘¨æœŸä¾‹å¦‚ componentDidMount è½¬åŒ–æˆ onReadyï¼ŒæŠŠäº‹ä»¶ç”±å¯èƒ½çš„ç±»å‡½æ•°ï¼ˆClass methodï¼‰å’Œç±»å±æ€§å‡½æ•°(Class property function) è½¬åŒ–æˆå­—é¢é‡å¯¹è±¡æ–¹æ³•ï¼ˆObject property functionï¼‰ç­‰ç­‰ã€‚</li>
<li>ä½†è¿™æ˜¾ç„¶ä¼šè®©æˆ‘ä»¬çš„ç¼–è¯‘æ—¶å·¥ä½œå˜å¾—éå¸¸ç¹é‡ï¼Œåœ¨ä¸€ä¸ªç±»å¼‚å¸¸å¤æ‚æ—¶å‡ºé”™çš„æ¦‚ç‡ä¹Ÿä¼šå˜é«˜ã€‚ä½†æˆ‘ä»¬æœ‰æ›´å¥½çš„åŠæ³•ï¼šå®ç°ä¸€ä¸ª createPage æ–¹æ³•ï¼Œæ¥å—ä¸€ä¸ªç±»ä½œä¸ºå‚æ•°ï¼Œè¿”å›ä¸€ä¸ªå°ç¨‹åº Page æ–¹æ³•æ‰€éœ€è¦çš„å­—é¢é‡å¯¹è±¡ã€‚è¿™æ ·ä¸ä»…ç®€åŒ–äº†ç¼–è¯‘æ—¶çš„å·¥ä½œï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åœ¨ createPage å¯¹ç¼–è¯‘æ—¶äº§å‡ºçš„ç±»åšå„ç§æ“ä½œå’Œä¼˜åŒ–ã€‚é€šè¿‡è¿è¡Œæ—¶æŠŠå·¥ä½œåˆ†ç¦»äº†ä¹‹åï¼Œå†ç¼–è¯‘æ—¶æˆ‘ä»¬åªéœ€è¦åœ¨æ–‡ä»¶åº•éƒ¨åŠ ä¸Šä¸€è¡Œä»£ç  Page(createPage(componentName)) å³å¯â€¦</li>
</ul>
<p><img src= "/img/loading.gif" data-src="https://m.360buyimg.com/img/jfs/t1/85776/36/7301/115301/5dfb42c2Eccb38a5f/aa0004a25a7ee488.png"></p>
<ul>
<li>å›åˆ°ä¸€å¼€å§‹é‚£æ®µä»£ç ï¼Œæˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ªç±»å±æ€§ configï¼Œconfig æ˜¯ä¸€ä¸ªå¯¹è±¡è¡¨è¾¾å¼ï¼ˆObject Expressionï¼‰ï¼Œè¿™ä¸ªå¯¹è±¡è¡¨è¾¾å¼åªæ¥å—é”®å€¼ä¸ºæ ‡è¯†ç¬¦ï¼ˆIdentifierï¼‰æˆ–å­—ç¬¦ä¸²ï¼Œè€Œé”®ååªèƒ½æ˜¯åŸºæœ¬ç±»å‹ã€‚è¿™æ ·ç®€å•çš„æƒ…å†µæˆ‘ä»¬åªéœ€è¦æŠŠè¿™ä¸ªå¯¹è±¡è¡¨è¾¾å¼è½¬æ¢ä¸º JSON å³å¯ã€‚å¦å¤–ä¸€ä¸ªç±»å±æ€§ state åœ¨ Page å½“ä¸­æœ‰ç‚¹åƒæ˜¯å°ç¨‹åºçš„ dataï¼Œä½†å®ƒåœ¨å¤šæ•°æƒ…å†µä¸æ˜¯å®Œæ•´çš„ dataã€‚è¿™é‡Œæˆ‘ä»¬ä¸ç”¨åšè¿‡å¤šçš„æ“ä½œï¼Œbabel çš„æ’ä»¶ transform-class-proerties ä¼šæŠŠå®ƒç¼–è¯‘åˆ°ç±»çš„æ„é€ å™¨ä¸­ã€‚å‡½æ•° handleClick æˆ‘ä»¬äº¤ç»™è¿è¡Œæ—¶å¤„ç†ï¼Œæœ‰å…´è¶£çš„åŒå­¦å¯ä»¥è·³åˆ° Taro è¿è¡Œæ—¶åŸç†æŸ¥çœ‹å…·ä½“æŠ€æœ¯ç»†èŠ‚ã€‚</li>
<li>å†æ¥çœ‹æˆ‘ä»¬çš„ render()å‡½æ•°ï¼Œå®ƒçš„ç¬¬ä¸€è¡Œä»£ç é€šè¿‡ filter æŠŠæ•°å­—æ•°ç»„çš„æ‰€æœ‰å¶æ•°é¡¹éƒ½è¿‡æ»¤æ‰ï¼ŒçœŸæ­£ç”¨æ¥å¾ªç¯çš„æ˜¯ oddNumbersï¼Œè€Œ oddNumbers å¹¶æ²¡æœ‰åœ¨ this.state ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨æŠŠå®ƒåŠ å…¥åˆ° this.stateã€‚å’Œ React ä¸€æ ·ï¼ŒTaro æ¯æ¬¡æ›´æ–°éƒ½ä¼šè°ƒç”¨ render å‡½æ•°ï¼Œä½†å’Œ React ä¸åŒçš„æ˜¯ï¼ŒReact çš„ render æ˜¯ä¸€ä¸ªåˆ›å»ºè™šæ‹Ÿ DOM çš„æ–¹æ³•ï¼Œè€Œ Taro çš„ render ä¼šè¢«é‡å‘½åä¸º _createDataï¼Œå®ƒæ˜¯ä¸€ä¸ªåˆ›å»ºæ•°æ®çš„æ–¹æ³•ï¼šåœ¨ JSX ä½¿ç”¨è¿‡çš„æ•°æ®éƒ½åœ¨è¿™é‡Œè¢«åˆ›å»ºæœ€åæ”¾åˆ°å°ç¨‹åº Page æˆ– Component å·¥å‚æ–¹æ³•ä¸­çš„ dataã€‚æœ€ç»ˆæˆ‘ä»¬çš„ render æ–¹æ³•ä¼šè¢«ç¼–è¯‘ä¸ºâ€¦</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">_createData</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">  <span class="built_in">this</span>.__state = <span class="built_in">arguments</span>[<span class="number">0</span>] || <span class="built_in">this</span>.state || &#123;&#125;;</span><br><span class="line">  <span class="built_in">this</span>.__props = <span class="built_in">arguments</span>[<span class="number">1</span>] || <span class="built_in">this</span>.props || &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> oddNumbers = <span class="built_in">this</span>.__state.numbers.filter(<span class="function"><span class="params">number</span> =&gt;</span> number &amp; <span class="number">2</span>);</span><br><span class="line">  <span class="built_in">Object</span>.assign(<span class="built_in">this</span>.__state, &#123;</span><br><span class="line">    oddNumbers: oddNumbers</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">this</span>.__state;</span><br><span class="line">&#125;...</span><br></pre></td></tr></table></figure>

<h4 id="6-3-2-WXML-å’Œ-JSX"><a href="#6-3-2-WXML-å’Œ-JSX" class="headerlink" title="6.3.2 WXML å’Œ JSX"></a>6.3.2 WXML å’Œ JSX</h4><p>åœ¨ Taro é‡Œ render çš„æ‰€æœ‰ JSX å…ƒç´ éƒ½ä¼šåœ¨ JavaScript æ–‡ä»¶ä¸­è¢«ç§»é™¤ï¼Œå®ƒä»¬æœ€ç»ˆå°†ä¼šç¼–è¯‘æˆå°ç¨‹åºçš„ WXMLã€‚æ¯ä¸ª WXML å…ƒç´ å’Œ HTML å…ƒç´ ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒå®šä¹‰ä¸ºä¸‰ç§ç±»å‹ï¼šElementã€Textã€Commentã€‚å…¶ä¸­ Text åªæœ‰ä¸€ä¸ªå±æ€§: å†…å®¹ï¼ˆcontentï¼‰ï¼Œå®ƒå¯¹åº”çš„ AST ç±»å‹æ˜¯ JSXTextï¼Œæˆ‘ä»¬åªéœ€è¦å°†å‰æ–‡æºç ä¸­å¯¹åº”å­—ç¬¦ä¸²çš„å¥‡æ•°å’Œå¶æ•°è½¬æ¢æˆ Text å³å¯ã€‚è€Œå¯¹äº Comment è€Œè¨€æˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬å…¨éƒ¨æ¸…é™¤ï¼Œä¸å‚ä¸ WXML çš„ç¼–è¯‘ã€‚Element ç±»å‹æœ‰å®ƒçš„åå­—ï¼ˆtagNameï¼‰ã€childrenã€å±æ€§ï¼ˆattributesï¼‰ï¼Œå…¶ä¸­ children å¯èƒ½æ˜¯ä»»æ„ WXML ç±»å‹ï¼Œå±æ€§æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé”®å€¼å’Œé”®åéƒ½æ˜¯å­—ç¬¦ä¸²ã€‚æˆ‘ä»¬å°†æŠŠé‡ç‚¹æ”¾åœ¨å¦‚ä½•è½¬æ¢æˆä¸º WXML çš„ Element ç±»å‹ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥å…ˆçœ‹ <View className='home'>ï¼Œå®ƒåœ¨ AST ä¸­æ˜¯ä¸€ä¸ª JSXElementï¼Œå®ƒçš„ç»“æ„å’Œæˆ‘ä»¬å®šä¹‰ Element ç±»å‹å·®ä¸å¤šã€‚æˆ‘ä»¬å…ˆå°† JSXElement çš„ ScrollView ä»é©¼å³°å¼çš„ JSX å‘½åè½¬åŒ–ä¸ºçŸ­æ¨ªçº¿ï¼ˆkebab caseï¼‰é£æ ¼ï¼ŒclassName å’Œ scrollTop çš„å€¼åˆ†åˆ«ä»£è¡¨äº† JSXAttribute å€¼çš„ä¸¤ç§ç±»å‹ï¼šStringLiteral å’Œ JSXExpressionContainerï¼ŒclassName æ˜¯ç®€å•çš„ StringLiteral å¤„ç†èµ·æ¥å¾ˆæ–¹ä¾¿ï¼ŒscrollTop å¤„ç†èµ·æ¥ç¨å¾®éº»çƒ¦ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ä¸¤ä¸ªèŠ±æ‹¬å·{} æŠŠå†…å®¹åŒ…èµ·æ¥â€¦</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å†æ€è€ƒä¸€ä¸‹æ¯ä¸€ä¸ª JSXElement å‡ºç°çš„ä½ç½®ï¼Œä½ å¯ä»¥å‘ç°å…¶å®å®ƒçš„çˆ¶å…ƒç´ åªæœ‰å‡ ç§å¯èƒ½æ€§ï¼šreturnã€å¾ªç¯ã€æ¡ä»¶ï¼ˆé€»è¾‘ï¼‰è¡¨è¾¾å¼ã€‚è€Œåœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬æåˆ°ï¼Œbabel-traverse éå†çš„ AST ç±»å‹æ˜¯å“åº”å¼çš„â€”â€”ä¹Ÿå°±æ˜¯è¯´åªè¦æˆ‘ä»¬æŒ‰ç…§ JSXElement çˆ¶å…ƒç´ ç±»å‹çš„é¡ºåºç©·ä¸¾å¤„ç†è¿™å‡ ç§å¯èƒ½æ€§ï¼ŒæŠŠå„ç§å¯èƒ½æ€§å¤§ç»“æœåº”ç”¨åˆ° JSX å…ƒç´ ä¹‹ååˆ é™¤æ‰åŸæ¥çš„è¡¨è¾¾å¼ï¼Œæœ€åå°±å¯ä»¥æŠŠä¸€ä¸ªå¤æ‚çš„ JSX è¡¨è¾¾å¼è½¬æ¢ä¸ºä¸€ä¸ªç®€å•çš„ WXML æ•°æ®ç»“æ„ã€‚â€¦</p>
<p>æˆ‘ä»¬å…ˆçœ‹ç¬¬ä¸€ä¸ªå¾ªç¯ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oddNumbers.map(<span class="function"><span class="params">number</span> =&gt;</span> <span class="xml"><span class="tag">&lt;<span class="name">Text</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>&#123;number&#125;<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span>);</span><br></pre></td></tr></table></figure>

<p>Text çš„çˆ¶å…ƒç´ æ˜¯ä¸€ä¸ª map å‡½æ•°ï¼ˆCallExpressionï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå‡½æ•°çš„ callee: oddNumbers ä½œä¸º wx:for çš„å€¼ï¼Œå¹¶æŠŠå®ƒæ”¾åˆ° state ä¸­ï¼ŒåŒ¿åå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ wx:for-item çš„å€¼ï¼Œå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°åº”è¯¥æ˜¯ wx:for-index çš„å€¼ï¼Œä½†ä»£ç ä¸­æ²¡æœ‰ä¼ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸ç®¡å®ƒã€‚ç„¶åæˆ‘ä»¬æŠŠè¿™ä¸¤ä¸ª wx: å¼€å¤´çš„å‚æ•°ä½œä¸º attribute ä¼ å…¥ Text å…ƒç´ å°±å®Œæˆäº†å¾ªç¯çš„å¤„ç†ã€‚è€Œå¯¹äº onClick è€Œè¨€ï¼Œåœ¨ Taro ä¸­ on å¼€å¤´çš„å…ƒç´ å‚æ•°éƒ½æ˜¯äº‹ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬åªè¦æŠŠ this. å»æ‰å³å¯ã€‚Text å…ƒç´ çš„ children æ˜¯ä¸€ä¸ª JSXExpressionContainerï¼Œæˆ‘ä»¬æŒ‰ç…§ä¹‹å‰çš„å¤„ç†æ–¹å¼å¤„ç†å³å¯ã€‚æœ€åè¿™è¡Œæˆ‘ä»¬ç”Ÿæˆå‡ºæ¥çš„æ•°æ®ç»“æ„åº”è¯¥æ˜¯è¿™æ ·â€¦</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  type: <span class="string">&#x27;element&#x27;</span>,</span><br><span class="line">  tagName: <span class="string">&#x27;text&#x27;</span>,</span><br><span class="line">  attributes: [</span><br><span class="line">    &#123; <span class="attr">bindtap</span>: <span class="string">&#x27;handleClick&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="string">&#x27;wx:for&#x27;</span>: <span class="string">&#x27;&#123;&#123;oddNumbers&#125;&#125;&#x27;</span> &#125;,</span><br><span class="line">    &#123; <span class="string">&#x27;wx:for-item&#x27;</span>: <span class="string">&#x27;number&#x27;</span> &#125;</span><br><span class="line">  ],</span><br><span class="line">  children: [</span><br><span class="line">    &#123; <span class="attr">type</span>: <span class="string">&#x27;text&#x27;</span>, <span class="attr">content</span>: <span class="string">&#x27;&#123;&#123;number&#125;&#125;&#x27;</span> &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;...</span><br></pre></td></tr></table></figure>

<p>æœ‰äº†è¿™ä¸ªæ•°æ®ç»“æ„ç”Ÿæˆä¸€æ®µ WXML å°±éå¸¸ç®€å•äº†</p>
<p>å†æ¥çœ‹ç¬¬äºŒä¸ªå¾ªç¯è¡¨è¾¾å¼ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numbers.map(<span class="function"><span class="params">number</span> =&gt;</span> number % <span class="number">2</span> === <span class="number">0</span> &amp;&amp; <span class="xml"><span class="tag">&lt;<span class="name">Text</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>&#123;number&#125;<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span>)...</span><br></pre></td></tr></table></figure>

<p>å®ƒæ¯”ç¬¬ä¸€ä¸ªå¾ªç¯è¡¨è¾¾å¼å¤šäº†ä¸€ä¸ªé€»è¾‘è¡¨è¾¾å¼ï¼ˆLogical Operatorsï¼‰ï¼Œæˆ‘ä»¬çŸ¥é“ expr1 &amp;&amp; expr2 æ„å‘³ç€å¦‚æœ expr1 èƒ½è½¬æ¢æˆ true åˆ™è¿”å› expr2ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªè¦æŠŠ number % 2 === 0 ä½œä¸ºå€¼ç”Ÿæˆä¸€ä¸ªé”®å wx:if çš„ JSXAttribute å³å¯ã€‚ä½†ç”±äº wx:if å’Œ wx:for åŒæ—¶ä½œç”¨äºä¸€ä¸ªå…ƒç´ å¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œæ‰€ä»¥æˆ‘ä»¬åº”è¯¥ç”Ÿæˆä¸€ä¸ª block å…ƒç´ ï¼ŒæŠŠ wx:if æŒ‚è½½åˆ° block å…ƒç´ ï¼ŒåŸå…ƒç´ åˆ™å…¨éƒ¨ä½œä¸º children ä¼ å…¥ block å…ƒç´ ä¸­ã€‚è¿™æ—¶ babel-traverse ä¼šæ£€æµ‹åˆ°æ–°çš„å…ƒç´  blockï¼Œå®ƒçš„çˆ¶å…ƒç´ æ˜¯ä¸€ä¸ª map å¾ªç¯å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŒ‰ç…§ç¬¬ä¸€ä¸ªå¾ªç¯è¡¨è¾¾å¼çš„å¤„ç†æ–¹æ³•æ¥å¤„ç†è¿™ä¸ªè¡¨è¾¾å¼ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ€è€ƒä¸€ä¸‹ this.props.text || this.props.children çš„è§£å†³æ–¹æ¡ˆã€‚å½“ç”¨æˆ·åœ¨ JSX ä¸­ä½¿ç”¨ || ä½œä¸ºé€»è¾‘è¡¨è¾¾å¼æ—¶å¾ˆå¯èƒ½æ˜¯ this.props.text å’Œ this.props.children éƒ½æœ‰å¯èƒ½ä½œä¸ºç»“æœè¿”å›ã€‚è¿™é‡Œ Taro å°†å®ƒç¼–è¯‘æˆäº† this.props.text ? this.props.text: this.props.childrenï¼ŒæŒ‰ç…§æ¡ä»¶è¡¨è¾¾å¼ï¼ˆä¸‰å…ƒè¡¨è¾¾å¼ï¼‰çš„é€»è¾‘ï¼Œä¹Ÿå°±æ˜¯è¯´ä¼šç”Ÿæˆä¸¤ä¸ª blockï¼Œä¸€ä¸ª wx:if å’Œä¸€ä¸ª wx:elseï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;block wx:<span class="keyword">if</span>=<span class="string">&quot;&#123;&#123;text&#125;&#125;&quot;</span>&gt;&#123;&#123;text&#125;&#125;&lt;/block&gt;</span><br><span class="line">&lt;block wx:<span class="keyword">else</span>&gt;</span><br><span class="line">    &lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">&lt;/block&gt;</span><br></pre></td></tr></table></figure></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">YolkPie</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://yolkpie.net/2020/10/17/Taro(%E4%BA%8C)/">https://yolkpie.net/2020/10/17/Taro(%E4%BA%8C)/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://yolkpie.net" target="_blank">YolkPie</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/10/17/Taro(%E4%B8%89)/"><img class="prev-cover" data-src="https://m.360buyimg.com/img/jfs/t1/118880/20/18814/113416/5f6ded26Ec120c939/bd3281048222ce87.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">Taro(ä¸‰)</div></div></a></div><div class="next-post pull-right"><a href="/2020/10/13/%E4%BA%AC%E4%B8%9C%E5%B0%8F%E7%A8%8B%E5%BA%8F-%E7%88%AC%E5%9D%91%E8%B7%AF-%E4%BA%8C/"><img class="next-cover" data-src="https://img11.360buyimg.com/imagetools/jfs/t1/144925/27/970/59191/5eec6d42Eee359811/8b7bbdb996007587.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">äº¬ä¸œå°ç¨‹åº-çˆ¬å‘è·¯-äºŒ</div></div></a></div></nav></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By YolkPie</div><div class="framework-info"><span>é©±åŠ¨ </span><a target="_blank" rel="noopener" href="https://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button id="readmode" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="font_plus" title="æ”¾å¤§å­—ä½“"><i class="fas fa-plus"></i></button><button id="font_minus" title="ç¼©å°å­—ä½“"><i class="fas fa-minus"></i></button><button class="translate_chn_to_cht" id="translateLink" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" title="è®¾ç½®"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script></body></html>